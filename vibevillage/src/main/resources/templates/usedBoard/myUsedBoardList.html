  <!DOCTYPE html>
  <html dir="ltr" lang="en-US">
  <head>
    <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=eaaccd59d5ca5cca9cba679898f98117&libraries=services" type="text/javascript"></script>

    <style>
      .product-status{
        font-size: large;
        font-weight: bold;
        text-align: -webkit-left;
      }
      .used_location_style{
        text-align: -webkit-left;
      }
    </style>
    <div th:replace="~{common/head :: head}"></div>
  </head>
  <body data-offset="60" data-spy="scroll" data-target=".onpage-navigation">
  <main>
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>
    <div th:replace="~{common/nav :: nav}"></div>
    <div class="main">
        <div id="map" style="width:100%; height: 500px;"></div>

      <section class="module-small">
        <div class="container">
          <form class="row">
            <div class="col-sm-2 mb-sm-20">
              <select class="form-control" id="province" name="province" onchange="updateCitySelect()">
                <option value="">도 선택</option>
                <option value="서울">서울특별시</option>
                <option value="부산">부산광역시</option>
                <option value="대구">대구광역시</option>
                <option value="인천">인천광역시</option>
                <option value="경기">경기도</option>
                <!-- 필요한 도 추가 -->
              </select>


            </div>
            <div class="col-sm-2 mb-sm-20">
              <select class="form-control" id="city" name="city" onchange="sendCategoryValue()">
                <option value="">시/군 선택</option>
                <!-- 시/군 항목은 자바스크립트로 동적으로 추가됩니다 -->
              </select>
            </div>
            <div class="col-sm-2 mb-sm-20" >
              <select class="form-control" id="category" name="category" onchange="sendCategoryValue()">

                <option value="0">전체</option>
                <option value="1">디지털기기</option>
                <option value="2">가구/인테리어</option>
                <option value="3">유아동</option>
                <option value="4">여성의류</option>
                <option value="5">여성잡화</option>
                <option value="6">남성패션/잡화</option>
                <option value="7">생활가전</option>
                <option value="8">생활/주방</option>
                <option value="9">스포츠/레저</option>
                <option value="10">취미/게임/음반</option>
                <option value="11">뷰티/미용</option>
                <option value="12">식물</option>
                <option value="13">가공식품</option>
                <option value="14">건강기능식품</option>
                <option value="15">반려동물용품</option>
                <option value="16">티켓/교환권</option>
                <option value="17">도서</option>
                <option value="18">유아도서</option>
                <option value="19">기타중고물품</option>
              </select>
            </div>
            <div class="col-sm-2" style="float: right;">
              <a th:href="@{/used/boardCreate}">
                <button class="btn btn-block btn-round btn-g" type="button" >글쓰기
                </button>
              </a>
            </div>

          </form>
        </div>
      </section>
      <hr class="divider-w">
      <section class="module-small">
        <div class="container">
          <div class="row multi-columns-row">
            <div class="col-sm-6 col-md-3 col-lg-3" th:each="item : ${usedList}">
              <div class="shop-item">
                <div>
                  <div th:with="boardId=${item.usedBoardId}">
                    <select class="form-control" id="product-status" name="product-status"
                            th:onchange="|convertProduct(${boardId})|">
                      <option th:selected="${item.usedBoardStatus} == '판매중'" value="판매중">판매중</option>
                      <option th:selected="${item.usedBoardStatus} == '판매완료'" value="판매완료">판매완료</option>
                    </select>
                  </div>
                </div>



                <div class="shop-item-image" th:each="image : ${item.images}">

                  <img alt="Accessories Pack" style="width: 345px; height: 345px" th:src="@{${image.PROJECTREACTOR} + ${image.uploadUniqueName}}"/>

                </div>
                <h4 class="shop-item-title font-alt">
                  <a th:href="@{/used/boardDetail/{id}(id=${item.usedBoardId})}">
                  <p th:text="${item.usedBoardTitle}"></p>
                  </a>
                </h4>
                <a th:href="@{/used/boardDetail/{id}(id=${item.usedBoardId})}">
                  <p style="font-weight: bold; text-align: left;" th:text="${item.usedBoardProductPrice + '원'}"></p>
                  <p class="used_location_style" th:text="${item.province}+' '+${item.city}+' '+${item.usedBoardLocation}"></p>
                  <p class="used_location_style" th:text="'카테고리:'+${item.categoryName}"></p>
                  <p class="used_location_style" th:text="'조회수:'+${item.usedBoardViews}"></p>
                </a>
                <a th:href="@{/used/update_board/{id}(id=${item.usedBoardId})}"><button class="btn btn-block btn-round btn-g" type="button">수정</button></a>
              </div>
            </div>
          </div>

        </div>
      </section>
      <hr class="divider-d">
    </div>
    <div class="scroll-up"><a href="#totop"><i class="fa fa-angle-double-up"></i></a></div>
  </main>
  <div th:replace="~{common/footer :: footer}"></div>
  <!--
  JavaScripts
  =============================================
  -->
  <div th:replace="~{common/js :: js}"></div>

  <script>
    $(document).ready(function(){
      $("select[name=category]").val("[[${category}]]");
      $("select[name=province]").val("[[${province}]]");
      $("select[name=citySelect]").val("[[${citySelect}]]");
    });

  </script>
  <script th:inline="javascript">


    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
            mapOption = {
              center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
              level: 3 // 지도의 확대 레벨
            };

    // 지도를 생성합니다
    var map = new kakao.maps.Map(mapContainer, mapOption);

    // 주소-좌표 변환 객체를 생성합니다
    var geocoder = new kakao.maps.services.Geocoder();

    // 주소로 좌표를 검색합니다
    geocoder.addressSearch(province+" "+citySelect, function(result, status) {

      // 정상적으로 검색이 완료됐으면
      if (status === kakao.maps.services.Status.OK) {

        var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new kakao.maps.Marker({
          map: map,
          position: coords
        });

        // 인포윈도우로 장소에 대한 설명을 표시합니다
        var infowindow = new kakao.maps.InfoWindow({
          content: '<div style="width:150px;text-align:center;padding:6px 0;">거래장소</div>'
        });
        infowindow.open(map, marker);

        // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
        map.setCenter(coords);
      }
    });
  </script>
  <script th:src="@{/js/usedBoard/cityCategory.js}"></script>

  </body>
  </html>
